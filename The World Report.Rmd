---
title: "The World Report"
author: "Us"
date: "April 26, 2019"
output:
  pdf_document: default
  html_document: default
  word_document: default
---
#I. Introduction:
Team clearly described the dataset and clearly described the motivation behind studying the data. Team provided
scholarly citations or quantitative facts to describe the motivation.

#II. Data Cleaning and Outlier Visualization:
Team clearly described their data cleaning and outlier removal process. Team presented insightful visualizations
motivating to do further exploratory or confirmatory analysis.

```{r message=FALSE, warning=FALSE, paged.print=FALSE,dpi=300, fig.width=20,fig.height=11}
#PART 1: Read csv, merge, clean and plot outliers.
library(readr)
library(readxl)
library(dplyr)
library(countrycode)
library(car)

source('Read_Clean.R')
cleaned <- Read_Clean()
```




#III. Dimension Reduction Analysis: 
Team applied dimension reduction analysis correctly and discussed the
motivation behind that. Also, they provided interesting insights into the
results.

##Part A: MDS
- ALL VARIABLES INCLUDED
-we can see Clusters
-Asia: we can see is the most spread out and has the most outliers, spreads across Africa to Europe 
-Africa is the opposite of Europe
-South America and North America are similar
-
```{r}
#PART 2: MDS
```
![image](img/3d.gif)

```{r message=FALSE, warning=FALSE, paged.print=FALSE, dpi=300, fig.width=8,fig.height=8}
# PART 3: PCA
library(pryr)
library(ggbiplot) #if the library is not present use the code below
#library(devtools)
#install_github("vqv/ggbiplot")
source('PCA.R')
(PrinCompPlot <- PCA(cleaned))
```
FROM PCA excluded are: pop_total, murder_pp, armed_pp, urban_pop_tot, investment_per_of_GDP
it is because they spoil correlation between variables and as such more PC would be needed to explain
the relation.

## PCA MEANING:
# PC1: Developed countries, HIGH loaded in: phones, life exp., less corrup., internet income 
# PC2: sex ratio is high, suicide low
# PC3: inequality is high

- ellipses to help visualize concentration of points. The size of ellipses is influenced by outlines.

- on the right we have develope countires: EU, North America where the most correlated are: less corruption, internet, life exp., phones, income.
- on the left have not as developed countries: Africa where Child mortality and children per woman and inequality is high.
-Asia is the most diverse continent (especially in PC2). It also has the highest sex ration (means more mean per woman). Super low PC2 for sex ration (Quatar, UAE)
- Central America & South are in the middle on the plot

- on PC1 & PC3 explain better Africa. (it is because PC3 is mostly about inequality and development)


```{r message=FALSE, warning=FALSE, paged.print=FALSE, dpi=300, fig.width=11,fig.height=7}
# PART 3: Hierarchical Clustering between Continents
library(ape)
source('cluster_continents.R')
Cl_continents <- cluster_continents(cleaned)
```
Include all variables

South, North and Europe are very similar. AND C America, Asia, Oceania and Africa are similar. Interesting is Africa is clustered with Oceania (with include Australia and NZ but also many small island which push Oceania into level of Africa)


```{r fig.height=10, fig.width=15, message=FALSE, warning=FALSE, dpi=300}
# PART 4: K-means & Model Based Clustering between Countries
library(mclust)
library(maptools)
source('clusters_countries.R')
Cl_countries <- clusters_countries(cleaned)

```

- compare chi.square test -> dependency between groups and continents. Model based groups are more similar to continents.

- model based (group7) difficult name (result for this group)
pop_total murder_pp armed_pp phones_p100 children_p_woman life_exp_yrs suicide_pp urban_pop_tot sex_ratio_p100
[1,] 239114394         0    0.011     146.317             2.07       78.053          0     118882678        148.681
     corruption_CPI internet_%of_pop child_mort_p1000 income_per_person investments_per_ofGDP   gini
[1,]         53.677           75.725           10.791          50579.31                29.942 39.722

- Developed countries are split into 3 groups.

- poor countries are the same in both models

- we lost "crowded" group from k-means. It transfoms into group 7 which describe high Income, Sex Ratio, Population, phones

```{r}
#PART 5: EFA
```


```{r}
#PART 6: CFA
```

